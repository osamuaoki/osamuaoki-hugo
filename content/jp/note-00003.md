---
title: キーボード入力モード選択
date: 2019-03-23T18:59:13+09:00
categories:
  - gnome
  - japanese
tags:
  - input-method
slug: gnome-uskb-im-select
---

## キーボード入力モード選択

Gnome等のLinuxの日本語環境でキーボード入力モード選択がトグル動作
（日本語/英語の交互切り替え)だと今どっちか分からなくなって結構不便です。

切り替えが、状態が分からなくとも一発でできるのが望ましいので、
その設定方法を以下に記します。

### 日本語キーボードの設定方法

日本語キーボードだと、変換と無変換キーを、Anthyの入力モード
HiraganaとLatinへの切り替えにAnthyの中のキーバインディングで
設定して常にibus-anthyで使うことで何とかなります。これは特に
問題ありません。

同じことを、WindowsのIMEでもALT-漢字、漢字、ALT-`等でのトグル
動作が嫌いで、Macの真似でこんなキーバインディングしています。
（最近のWindows10はどうも噂ではこんな感じのキーバインドのようですね。）

### 英語キーボードでの課題

ただ、英語キーボードの場合は変換と無変換キーはありません。

  * SHIFTと普通の文字との組み合わせは論外。
  * CTRLと普通の文字との組み合わせも、VIM使うので全部先約有り。
  * ALTと普通の文字との組み合わせも、メニューへのショートカットで全部先約有り。

こういったことも有り、私はCTRL-SPACE, SHIFT-SPACEを一時使っていました

ところが、SHIFT-SPACEやCTRL-SPACEもLokalizeなどのアプリ
が使っていました。（ALT-SPACEは既にGNOMEが使っている）

こうなると、お手上げです。

### 英語キーボードでの設定方法 (Gnome)

アプリとの喧嘩を避けるにはGUI用にリザーブされている、GUIキー（SUPERと
かWindowsキーともいう)やMENUキー等を入力モード選択に使うのが良いわけです。

ただこれはAnthyなどのアプリからは使えません。

そこで、GNOMEの設定→デバイス→キーボードの登場です。

まず、使いたくないデフォルト設定のSUPER-SPACEやSUPER-SHIFT-SPACEを
TYPINGにある設定を選び、出てきた設定変更の画面でバックスペースを用いて
ともに無効にします。

つぎに、設定リストの一番下のプラスをたたき、新規定義を追加します。

ここで、使用するINPUT METHODが２つしか無いとします。英語とANTHYとしましょう。

inputSources[0]がANTHYとすると、変換キーはないので右にあってまず使わない
MENUキーをあてがいましょう。Commandは長いけど１行で入れてください。
```
Name     InputMethod_0
Command  gdbus call --session --dest org.gnome.Shell --object-path /org/gnome/Shell --method org.gnome.Shell.Eval  "imports.ui.status.keyboard.getInputSourceManager().inputSources[0].activate()"
Shortcut MENU
```

もし、MENUキーを使うのが嫌ならSUPER-,、SUPER-.、SUPER-/などの右下の
キーとSUPERの組み合わせが使いやすい気がします。（２つ以上のインプットメソッド
を使うときに便利ですね。)

inputSources[1]がENGLISHとすると、これには使わなくなったSUPER-SPACE
をあてがいましょう。

```
Name     InputMethod_1
Command  gdbus call --session --dest org.gnome.Shell --object-path /org/gnome/Shell --method org.gnome.Shell.Eval  "imports.ui.status.keyboard.getInputSourceManager().inputSources[1].activate()"
Shortcut SUPER-SPACE
```

そしてANTHYは常にHiraganaとしておけばよしです。

ちょっとこれで使ってみましょう。(実は、ANTHY選択をSUPER-/とMENUの
両方の設定にして、英語もSUPER-,とSUPER-SPACEの両方の設定にして、
どのキーが使いやすいかは比較検討中です。)
