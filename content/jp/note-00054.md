---
title: STM32F411CE (4)
date: 2022-09-01
categories:
  - iot
  - japanese
tags:
  - blackpill
slug: blackpill-4
---

## cgg56の反省と改造

ARM系のMCU使用の練習に[STM32F411CE (1)]({{<ref "note-00043.md">}})で
作ったcgg56は結局 JoyStick は動きましたが、それほど操作性はよく
ありませんでした。

横に押すと、横にキーボード自体が動いてしまうという問題を抱えていました。

そこでスプリットキーボードを試したかったので、ノコギリで２つに切り
ポインティング部品無しで構成する改造をすることにしました。

ポインティングデバイスを除いたスペースには、キースイッチを追加します。

切り離して短くなったMCUボード無しの側は、ホームセンターで5mm角の
アクリル棒で追加購入しセメダインで接着延長して対象に仕上げ、追加
のMCUボードを取り付けました。左右接続は、余っていたUSB用のケーブルを
両端切りコネクター無しで直結して対応します。できた物はcgs58と名付けます。

## PIN接続 (cgs58)

canterを参考にピン配置を決めました。

ところで、(R0, C0)はキーボードをキー面上から見て左上です。

以下の図もキーボードをキー面上から見て(TOP VIEW)ですので、実際の配線では
左右が逆になります。

C6xとC7xは、C6とC7の内側のMCUボード横の穴にいれたキー向けの追加のカラムです。

LTは左手側、RTは右手側です。

```
Blackpill (TOP VIEW)


    LT      RT                                       RT      LT
                                  USB-C
                            +---+-----+---+
    R0      R0  ------- B12 |*  |     |  *|5V  -----
    R1      R1  ------- B13 |*  |     |  *|GND -----
    R2      R2  ------- B14 |*  |     |  *|3V3
    R3      R3  ------- B15 |*  +-----+  *|B10       C7x         
    C0          ------- A8  |*  B     N  @|B2 ------ *** BOOST1
        [USB]   ------- A9  |*  O     R  @|B1 ------ XX
        [USB]   ------- A10 |*  O     S  @|B0 ------ XX
        [USB]   ------- A11 |*  T     T  *|A7 ------ 
        [USB]   ------- A12 |*  0        *|A6 ------ C7x
    C3          ------- A15 |*           *|A5 ------ C11  
    C2          ------- B3  |*           *|A4 ------ C10  
    C5          ------- B4  |*           *|A3 ------ C7 
    C6          ------- B5  |*           *|A2 ------ C8
    TX==\ /=TX  ------- B6  |*           *|A1 ------ C9 
    RX==/ \=RX  ------- B7  |*           *|A0 ------ *** USR
    C1          ------- B8  |*  K        *|R  ------ *** NRST (/RST, ~RST)
    C4          ------- B9  |*  E        *|C15 ----- C12
    **==5V==**  ------- 5V  |*  Y        *|C14 ----- C13     C6x
    **==GND=**  ------- GND |*           *|C13 ------*** BLUE LED
                        3V3 |*  @ @ @ @  *|VB
                            +-------------+
                                ^ ^ ^ ^
                                | | | |
          3V3    ---------------+ | | |
        SWDIO    -----------PA13--+ | |
        SWSCK    -----------PA14----+ |
          GND    ---------------------+
```

## 配線確認

実際には、連結以外の配線をして、qmkを書き込み配線確認をします。

* cgh29L
* cgh29R

WIP ...

<!-- vim: se ai tw=79: -->

