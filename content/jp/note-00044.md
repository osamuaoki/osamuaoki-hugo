---
title: QWFRTY配列
date: 2022-02-14
categories:
  - iot
  - japanese
tags:
  - qwfrty
slug: qwfrty
---

## 背景

MCUを使ったIOTの初等プロジェクトとして、QMKを利用したキーボードを作りました。

結局デフォルトのキー配列に採用したのは、QWERTY配列でした。

ずぼらな性格上、DVORAK, COLMAK, WORKMAN, COLEMAK-DHのいずれも学習障壁が高すぎました。

さらにこれらの有名配置だと、VIエディターでのカーソール移動がVIのデフォルト設定では難しくなってしまいます。

ただ、これでは残念なので、「QWFRTY配列」を考え最適化配列実験用に設定しました。おもしろいのでここに要点をメモしておきます。

最新の詳細状況は、[私のQMKソース](https://github.com/osamuaoki/qmk_firmware/blob/osamu1/keyboards/cgc56/keymaps/default/keymap.c)を見ないと分かりませんが。
小さなキーボードでカーソールやINSまで押し込んだので、実際には最右下のキーは、カーソルキーが割り込みもう一つ右に離れています。
ただ直交系キーボード配列なので、比較的に使わない"/"キーだし、元々下のキーQWERTYよりは左によっているので問題はないようです。。

## QWFRTY配列

私は、せっかく作ったQMKを利用した自作キーボードのいわゆる最適化キー配列として、11個のキーだけが標準のQWERTYから移動された非QWERTY配列としています。

```
       LEFT HAND                 RIGHT HAND
│ Q │ W │_F_│ R │ T │      │ Y │_D_│_K_│_G_│ P │
│ A │_O_│_E_│_I_│_U_│      │_S_│_H_│_J_│ L │ ; │
│ Z │ X │ C │ V │ B │      │ N │ M │ , │ . │ / │
```

まあ、所詮実験レベルのお遊びですが、我ながら悪くない気もします。

### QWERTY配列からの変更点（覚え方）:

キーの移動を以下の様にとらえると覚えられます。

* "EOIU" -> DVRAK配列の位置に移動。 ("E"は下一段、子音文字"SDFG"を除去。外側文字は反対の手の外側に順番に移動)
* "HJKL"を逆Tのカーソールキー位置関係に移動。("L"を軸に1つづつ移動、ホームを空ける)
* まず、"F" を左上の空きにななめ1つ移動。
* 残りの"SDG" をこの順番・位置関係を維持しながらで右の空きスペースに順番に移動。

### QWFRTY設計の方針と結果:

* eucalyn/dvrak配列の様に母音 (aoeiu) を左手に集める。
    * 交互打鍵をでき、特に日本語との相性も良い
    * 特に頻出の"E"がホームに来るのは大きい
    * それなりによく使う"S" "D"は動きの良い人差し指
* キー移動を必要最小限化する colemak/workman配列のコンセプトは継承。
    * QWERTYからの移行のメンタルストレスが少ない。
* eucalyn配列の vimのカーソールキー (hjkl) をまとめるアイデアを拝借
    * QWERTYよりむしろ使い安くなった（？）

### QWFRTY配列のキー移動の統計:

* 11/30のキーが移動(下記の他の半分なので、覚えやすい)
* 大移動は7/30キーのみ

### QWFRTY設計の背景事実：

#### 文字数頻度指標

(log圧縮済み、QMKのソース利用)は以下です。（大きいほどよく出てくるので、使いやすいところに置きたい文字）

* `s=26.2 d=26.2 f=16.9 g=9.4` `*.c` `*.h`
* `s=20.1 d=14.4 f=8.2  g=6.7` `*.md`

#### 交互打鍵・日本語入力

"f" は日本ではあまり使わない子音なので、交互打鍵を考えた際に子音だが母音側にあっても悪影響が少ない

#### 右配置の総合的優先順位

`s > d > g`

## 他のキー配列

* https://yushakobo.jp/blog/pluis9/2017/12/thinkkeylayout/

標準の「QWERTY配列」以外は、新しいキー配列提案が先に並んでいます。

以下は重要30キーにのみフォーカスし、Ortholinear系・ERGODOX系を意識した位置表示です。

### QWERTY配列
```
       LEFT HAND                 RIGHT HAND
│ Q │ W │ E │ R │ T │      │ Y │ U │ I │ O │ P │
│ A │ S │ D │ F │ G │      │ H │ J │ K │ L │ ; │
│ Z │ X │ C │ V │ B │      │ N │ M │ , │ . │ / │
```
* 0/30キーが移動(デフォルト)

### Eucalyn

* https://eucalyn.hatenadiary.jp/entry/saikyo-interface (2017-12-21 初期形)
```
│ / │ , │ . │ F │ Q │      │ M │ R │ D │ Y │ P │
│ A │ O │ E │ I │ U │      │ G │ T │ K │ S │ N │
│ Z │ X │ C │ V │ W │      │ B │ H │ J │ L │ ; │
```
* 23/30キーが移動

* https://eucalyn.hatenadiary.jp/entry/about-eucalyn-layout (2018-08-31 完成形)
```
│ Q │ W │ , │ . │ ; │      │ M │ R │ D │ Y │ P │
│ A │ O │ E │ I │ U │      │ G │ T │ K │ S │ N │
│ Z │ X │ C │ V │ F │      │ B │ H │ J │ L │ / │
```
* 20/30キーが移動

### Colemak Mod-DH

* https://colemakmods.github.io/mod-dh/
```
│ Q │ W │ F │ P │ B │      │ J │ L │ U │ Y │ ; │
│ A │ R │ S │ T │ G │      │ M │ N │ E │ I │ O │
│ Z │ X │ C │ D │ V │      │ K │ H │ , │ . │ / │
```
* 17/30キーが移動

### WORKMAN

* https://workmanlayout.org/
```
│ Q │ D │ R │ W │ B │      │ J │ F │ U │ P │ ; │
│ A │ S │ H │ T │ G │      │ Y │ N │ E │ O │ I │
│ Z │ X │ M │ C │ V │      │ K │ L │ , │ . │ / │
```
* 21/30キーが移動

### Colemak

* https://colemak.com/
```
│ Q │ W │ F │ P │ G │      │ J │ L │ U │ Y │ ; │
│ A │ R │ S │ T │ D │      │ H │ N │ E │ I │ O │
│ Z │ X │ C │ V │ B │      │ K │ M │ , │ . │ / │
```
* 19/30キーが移動

### Dvorak mod-slash

* https://en.wikipedia.org/wiki/Dvorak_keyboard_layout

```
│ / │ , │ . │ P │ Y │      │ F │ G │ C │ R │ L │
│ A │ O │ E │ U │ I │      │ D │ H │ T │ N │ S │
│ ; │ Q │ J │ K │ X │      │ B │ M │ W │ V │ Z │
```
* 28/30キーが移動

適用対象がOrtholinear配列のため「`'`」が「`/`」となっている。（「`'`」は真ん中のどのキー配列でも上記枠外の隙間に配置済み）

## 文字頻度

QMK の`quantum/`中や`docs/`中を統計して、スペースの数を１００としている。"`*`"はログ圧縮して大局観が分かるようになっています。

```
Cソースコード                  ドキュメンテーション中
" "  = 100.0 **********
"a"  = 32.2 ********           "a"  = 22.2 *******
"b"  =  9.5 *****              "b"  =  6.5 *****
"c"  = 23.7 *******            "c"  = 13.3 ******
"d"  = 26.2 *******            "d"  = 14.4 ******
"e"  = 61.9 *********          "e"  = 37.7 ********
"f"  = 16.9 ******             "f"  =  8.2 *****
"g"  =  9.4 *****              "g"  =  6.7 *****
"h"  = 10.3 ******             "h"  = 11.1 ******
"i"  = 38.3 ********           "i"  = 22.1 *******
"j"  =  0.5 *                  "j"  =  0.3 *
"k"  = 10.6 ******             "k"  =  5.5 ****
"l"  = 18.2 *******            "l"  = 13.5 ******
"m"  = 14.3 ******             "m"  =  9.8 *****
"n"  = 30.7 *******            "n"  = 19.4 *******
"o"  = 31.4 *******            "o"  = 23.4 *******
"p"  = 13.9 ******             "p"  =  8.3 *****
"q"  =  0.9 *                  "q"  =  1.0 **
"r"  = 30.3 *******            "r"  = 19.4 *******
"s"  = 26.2 *******            "s"  = 20.1 *******
"t"  = 41.0 ********           "t"  = 27.7 *******
"u"  = 15.4 ******             "u"  = 10.9 ******
"v"  =  5.9 *****              "v"  =  3.3 ****
"w"  =  5.7 *****              "w"  =  4.4 ****
"x"  =  5.5 ****               "x"  =  1.6 **
"y"  =  9.3 *****              "y"  =  6.5 *****
"z"  =  0.5 *                  "z"  =  0.2 *
````

ちなみにCの場合記号でスペース比較で約４％以上の頻度は以下だけでした。

```
" "  = 100.0 **********
"""  =  3.5 ****
"#"  =  6.2 *****
"("  = 10.5 ******
")"  = 10.5 ******
"*"  =  6.2 *****
","  =  6.7 *****
"."  =  4.4 ****
"/"  =  6.4 *****
"0"  =  6.3 *****
";"  =  7.0 *****
"="  =  4.8 ****
"_"  = 35.9 ********
```
これもあって「`_` 」 はスプリット直交配置の真ん中に特別にシフト無しでアクセスできるようにしてます。

<!-- vim: se ai tw=79: -->


