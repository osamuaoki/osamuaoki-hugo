---
title: AVRISP markII mod-VCC (J)
date: 2020-02-27
categories:
  - DIY
  - japanese
tags:
  - avrdude
slug: avrisp-mod-j
---

AVRチップのISPプログラマにAVR ISP markIIを使うと、対象AVRチップに別途電源供給
する必要があり、ISP出力のPIN#2にVCCを供給していた以前の
[TTL-232R-5V を使った自作プロクラマー](https://github.com/osamuaoki/avrdude-friend)
を使うより煩雑でした。

そこで、AVR ISP markIIを改造し、ISP出力のPIN#2にVCCを供給出きるように改造し
ました。


## 参考情報

いろんな人が不便と感じ、AVRISP mkIIのUSB から電源を取り、ISP出力のPIN#2 に
つなぎVCC電源供給ソースとする改造記事を書いています。以下の改造記事を参考に
しました。

* http://www.webx.dk/avrisp-mk2-modding/ (3V/5V selectable, use own fuse, easy output)
* https://jeelabs.org/2010/04/02/avrisp-mkii-w-5v-power/ (nice input after poly fuse)
* https://forum.arduino.cc/index.php?topic=125502.0 (half ass fix, Nice pics of
  wiring, good output point)
* https://qiita.com/hideyuki/items/71381b741d89878e3e79 (Easy access via TP1, No fuse)
* http://shiozoku.blogspot.com/2014/02/avr-isp-mkii.html Use switch (No fuse,
  interesting use reminder)
* https://electronics.stackexchange.com/questions/286693/can-anything-be-done-about-this-avrisp-mkii-or-is-it-dead
  (Nice pics of wiring, not the same purpose, fix by bypassing broken
  DC/DC)　これは本改造とは違う修理改造。

これらの記事の基板の方が私の持っている基板より配線が太く見やすいです。

これらを読んでの本改造の利用上の注意点は、裸のチップにつなぐ際に電源からの
ノイズまわりこみ防止に、チップ側にパスコン（0.1uF+10uF）を付けるのが賢明の
ようです。

保安回路ですが、ダイオードは負の高圧には効ず有効なケースが想定できなかっ
たので、半田付け点をUSBコネクターにしたため必要な正入力側のポリスイッチだけ
にしました。

## 作成

### 設計方針

私としては、以下の方針で改造設計しました。

* 本来の外部電源供給と検出という使い方ができる
* 非供給・3V供給・5V供給の、切り替え可能
* 動作モードが簡単に変えられ過ぎないこと（切り替えスイッチにはしない）
* 熱に弱い部品（コンデンサー）の周囲での半田付けをしない
* 追加部品は基本USBコネクター上部に固定（エポキシ接着剤利用）
* 保安部品のポリヒューズはホストPCとつなぐUSBコネクター側に設置
* 3.3Vは専用LDOを利用し回路簡素化

### 使用部品

* [NJU7223F33　3.3V専用LDO](http://akizukidenshi.com/catalog/g/gI-00432/)
* [表面実装ポリスイッチ　１００ｍＡ](http://akizukidenshi.com/catalog/g/gP-01316/)
* [片面ガラス・ユニバーサル基板　カット片](http://akizukidenshi.com/catalog/g/gP-00517/)
* [ピンヘッダ カット片 2PIN](http://akizukidenshi.com/catalog/g/gC-00167/)
* [分割ロングピンソケット　カット片 5PIN](http://akizukidenshi.com/catalog/g/gC-05779/)
* AWG30撚り線
* AWG24単線（CAT５の芯線）
* エポキシ接着剤


### 追加回路図

[追加回路図](/img/avrisp2_mod.pdf)です。

### 完成写真

全体 ![全体](/img/AVRISP-mod.jpg)
中の上から ![中の上から](/img/AVRISP-mod-top.jpg)

中のISP裏 ![中のISP裏](/img/AVRISP-mod-isp.jpg)
中のUSB裏![USB裏](/img/AVRISP-mod-usb.jpg)

### 作成結果

![作成結果 蓋開けて上から](/img/avrisp2_mod1.jpeg)
![作成結果 USBコネクター周囲の横から](/img/avrisp2_mod2.jpeg)

<!-- vim: se ai tw=79: -->
