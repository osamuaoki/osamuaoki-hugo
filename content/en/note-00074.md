---
title: "Re-learning Vim (8)"
date: 2024-06-04T00:00:00+00:00
categories:
  - desktop
  - english
tags:
  - vim
slug: vim-learn-8
---

## Nvim configuration retrospective

I have been updating Nvim configuration with LazyVim as described in
[Re-learning Vim (7)]({{< ref "note-00040.md" >}}) to make it behave as close
as plain Nvim.

## Vim configuration touch-ups

In order to make my Vim experience to match my LazyVim/Nvim configuration, I
updated my `.vimrc`.

* [osamu's ~/.vimrc file](https://github.com/osamuaoki/dot-vim/blob/master/.vimrc)

## Folding of markdown file

I have always used `gq` under visual line mode to rewrap range of lines within
`'textwidth`.  Since LazyVim sets `'formatexpr`, it doesn't work as expected
any more for some `'filetype` such as `markdown`.

Easy workaround is to use `gw` instead.

## Revising basics -- quickfix

I feel I need to revisit some key baseline Vim operation techniques beyond the
use of keyboard MACRO.

| "quickfix list"    | "location list"     | functionality              |
|--------------------|---------------------|----------------------------|
| global list        | window-local list   | scope of list              |
| `:vim[grep]`         | `:lv[imgrep]`         | Vim internal search        |
| `:gr[ep]`            | `:lgr[ep]`            | Vim external search        |
| `:helpg[rep]`        | `:lh[elpgrep]`        | Help message search        |
| `:mak[e]`            | `:lmak[e]`            | Error messsage search      |
| `:cope[n]`           | `:lop[en]`            | Open list of errors/matches |
| `:ccl[ose]`          | `:lcl[ose]`           | Close list of errors/matches |
| `:cdo {cmd}`         | `:ld[o] {cmd}`        | Execute `{cmd}` for all errors/matches |
| `:cc`                | `:ll`                 | Display error/match        |
| `:cn[ext]`           | `:ln[ext]`            | Display next error/match   |
| `:cp[revious]` or `:cN` | `:lp[revious]`  or `:lN` | Display previous error/match |
| `:cfir[st]`          | `:lfir[st]`           | Display first error/match |
| `:cla[st]`           | `:lla[st]`            | Display last error/match |
| `:cli[st]`           | `:lli[st]`            | List all errors/matches |

Here, `{cmd}`  is like `s/foo/bar/gc`.

LazyVim and my updated `~/.vimrc` map `[q` and `]q` to `:cprevious<cr>` and `:cnext<cr>`.

## Ex-mode command line

There are special characters for EX-mode command line.

* `##` : substitute with all names in the argument list when executed
* `%` : substitute with the current file name when executed
* `<c-r>%` : insert the current file name to the command line
* `%<tab>` : insert the current file name to the command line

If the faster `rg` (`ripgrep` package) is used for `:grep`, it can offer
optimal recursive tree search from the current working tree by
not-specifying the target file in Ex-mode command line.

Wildcard expressions such as `*`, `*.txt`, `**.md`, ..., parsed by the
enderlining shell (Bash) may be useful.
| `:cope[n]`           | `:lop[en]`            | Open list of errors/matches |
| `:ccl[ose]`          | `:lcl[ose]`           | Close list of errors/matches |

## Use case (manual changes)

* At shell prompt, enter: `vi file1.txt file2.txt`
* In Vim/Nvim normal mode, enter `: gr 'pattern' ##`
* Open quickfix window with `:copen`
* Move and press within quickfix window to jump to matching location in target files.
* Use `]q` or `[q` to navigate in target files and make manual changes.
* Close quickfix window with `:cclose`
* Save all and quit with `:wqa`

## Use case (automatic changes)

* At shell prompt, enter: `vi file1.txt file2.txt`
* In Vim/Nvim normal mode, enter `:gr 'pattern' ##`
* Substitute all with confirmation with `:cdo 's/pattern/subststring/gc'`
* Save all and quit with `:wqa`

## Filter quicklist

* Load `cfilter` with: `:packadd cfilter`
* Remove matched from quicklist with `:Cfilter! /exclude_pattern/`
* Select matched in quicklist with `:Cfilter /include_pattern/`



<!-- vim: set sw=4 sts=4 ai si et tw=79 ft=markdown: -->
