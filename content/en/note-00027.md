---
title: "Re-learning Vim (3)"
date: 2021-09-12T05:22:00+00:00
categories:
  - desktop
  - english
tags:
  - vim
slug: vim-learn-3
---

## Neovim migration

After finding out **Neovim** (nvim) starts up 30%-40% faster than **Vim 8**
probably due to asynchronous processing and more effective use of multi-core
modern CPU, I decided to migrate to nvim.  Then lua thing got my attention.
Since nvim source package for version 0.5 was available in Debian experimental,
I made a local package from it.  So I am in good shape to try the latest lua
scripts.

After translating my old vimrc to lua as https://github.com/osamuaoki/dot-nvim
, I realized this isn't going anywhere.  It was easy to convert
`.config/nvim/init.vim` but it was hard to decide how to migrate all my vimL
based packages to new new lua based ones.

I found 3 interesting projects which offer examples for how this is done.

* Lunar Vim
  * SRC: https://github.com/LunarVim/LunarVim
  * HOME: https://www.lunarvim.org/#opinionated
* NvChad
  * SRC: https://github.com/NvChad/NvChad
  * WIKI: https://github.com/NvChad/NvChad/wiki (old?
  * HOME: https://nvchad.netlify.app/
* DOOM-NVIM
  * SRC: https://github.com/NTBBloodbath/doom-nvim

For ease of customization, I chose NvChad.  Result was great start-up time
reduction.

* vim  230 ms (dot-vim in vimL)
* nvim 161 ms (dot-nvim in lua starting vimL packages)
* nvim  65 ms (NvChad in all lua)  -- use lazy loading
* nvim  59 ms (doom-nvim in all lua) -- use lazy loading more(?)

Here is my memo on how to use DOOM-NVIM and customize it.

## Terminal settings

Set DEL-code(0x7F) for Backspace and use escape sequence for Delete.  This
frees the ASCII BS (CTRL-H) code so window jump can be mapped to `<C-H>`.

Now I see why this was default.

## Key bindings

I am keeping mostly default key bindings for now.

* Vim's original key bindings:
    * `:help index`
* Configuration introduced key bindings (with opened empty file):
    * `:put =execute('nmap')` etc.
* `which-key.nvim` also solves allow us to set timeoutlen to be short (500ms
  instead of default 1000ms).
    * `which-key.nvim` is good for dummy like me.
    * This makes `jk` for `<Esc>` not so clunky.
* `<C-SPACE>` is used by some package.  This needs to be moved to allow
  Japanese input for me.
    * `F6`-`F10`, `ALT`/`SHIFT`/`WIN-SPACE` should be off limit.
* securemodelines, spell-under, ale -- think about including

In order to always start nvim, I created nv as its alias.

## Dependency package management

Any of these packer based system, it is good idea to run followings after
editing the system.

```
$ nvim -c "autocmd User PackerComplete quitall" -c "PackerSync
```

## Main configuration management

In order to minimize conflict, I now use `git pull --rebase` to my local
branch.  (Probably using upstream provided interface)

<!-- vim: set sw=2 sts=2 ai si et tw=79 ft=markdown: -->
