---
title: "Re-learning Vim (2)"
date: 2019-09-24
categories:
  - desktop
  - english
tags:
  - vim
slug: vim-learn-2
---

Let's review a few interesting plugins.

Please note that I manage plugins via Vim 8's native plugin management
framework.

As of 2021-08-27, I mostly use the latest version from github:

* ale
* securemodelines
* vim-spell-under (I wrote)
* vim-better-whitespace
* vim-indent-guides
* gnupg (provided by vim-scripts)
* matchit (provided by vim)
* vim-python-matchit (I use locally patched 0.5)
* vim-airline
* vim-airline-themes

(vim-gitgutter is interesting but I don't work on repo with many contributors.)

Please note some basic configuration settings including plugin management are at
[~/.vim/vimrc](https://github.com/osamuaoki/dot-vim/blob/master/vimrc).

To disable package, comment out corresponding `packadd!` line with leading `"`.

All other initialization code is provided as plugin.

Basic rule: Less customization is better.

For hard to reach Esc-key issue, use CapsLock for it via GNOME Tweak setting.

I set the GNOME terminal's font to Hack.  This has easy-to-identify `0oO` and
`1lI` fonts and the cute  non-standard glyphs used for producing cute bar with
airline..

## `~/.vim/vimrc`

Let's list highlight of configuration.  Local configuration for each plugins
are also included in this
[~/.vim/vimrc](https://github.com/osamuaoki/dot-vim/blob/master/vimrc) file.

### Map `<F2>` to toggle PASTE MODE in INSERT MODE

Adjust PASTE MODE by `F2`-key.

```
set nopaste
set pastetoggle=<f2>
```

### Map `Q` to `@q` in NORMAL MODE

Record and apply keyboard MACRO just with `q`-key. ("qq" to start recording
MACRO, "qq" to quit recording MACRO, "Q" to apply MACRO)
```
nnoremap Q @q
xnoremap Q :norm @q<cr>
```

### Map `<Esc><Esc>` to `<C-\><c-n>` in TERMINAL-JOB MODE

Since TERMINAL-JOB MODE feels like INSERT/REPLACE MODE, I didn't like vim style
`<C-w>N` nor odd neovim style `<C-\><c-n>` to get out.  I accidentally typed
`<C-w>` in INSERT MODE to lose data.  Now I can always bang on `<Esc><Esc>`
everywhere first if I want to move around windows.

Remapping `<Esc><Esc>` instead of `<Esc>` avoids causing interference with the
terminal escape code (ISO color etc.).

```
nnoremap Q @q
xnoremap Q :norm @q<cr>
```

## `dense-analysis/ale`

**This is used a lot**

Very nice syntax checker.

It is important to use static checker for interpreter languges since they
usually don't complain even if typo causes unused/non-assigned variables.

I use this with:

* shell: `shellcheck`
* python3: `pylint` and `flake8` (These needs to be set to be quiet to avoid
  excessive noise.)  See
  https://github.com/osamuaoki/osamu-utils/tree/main/dot/.config for backed up
  settings.

I may need to check:

* https://github.com/dense-analysis/ale (FAQ)
* https://www.vimfromscratch.com/articles/vim-and-language-server-protocol/
* https://github.com/rhysd/vim-lsp-ale
* https://github.com/prabirshrestha/vim-lsp

## `ciaranm/securemodelines`

Features like "modeline" is very convenient but it may become source of
security concern.  This plugin disables Vim's native capability for "modeline"
but still enables very limited commands to be parsed.

Since this works even under "`:set nomodeline`" default start scheme, I am
using this all the time.

## `osamuaoki/vim-spell-under`

When syntax highlist and spell checker are activated together, text becomes
difficult to read in some cases in terminal.  This forces spell checker to use
underline.

## `ntpeters/vim-better-whitespace`

This is a new improved version of `bronson/vim-trailing-whitespace` .  This
takes care all weird UTF-8 spaces too.

* Mark all types of spaces in wrong position on display.
* Strip tailing spaces upon hitting "`<SPACE>s`" only.

My configuration marks all problematic spaces but only remove problematic
dangling spaces upon explicit user request.  (So the annoyance noticed by #vim
Recommendations is addressed.)

## `nathanaelkane/vim-indent-guides`

This is a plugin for visually displaying indent levels in Vim.

Unlike using vim native approach of "`:set list`" with "`:set listchars=...`"
to visualize TAB and tailing spaces, `vim-better-whitespace` and
`vim-indent-guides` doesn't cause problem when selecting screen area with
mouse-drags.

## `gnupg` (vim-scripts)

This let you use gnupg.

## `matchit` (vim internal and optional)

This let you move between matching `{` and `}` and similar pairs.

## `osamuaoki/vim-python-matchit`

This let you move between matching `if`/`try`-block sections and
`for`/`while`-block sections in python.  Since `for`/`while` can have `else` in
python, I patched upstream 0.5 to cover this case.

## `romainl/vim-qlist`

**This has not been used much but interesting.  (commented out now)**

Native behavior of `[I`, `]I`, `[D`, and `]D` to search the keyword and the
macro definition is a bit half baked.  It should be much nicer if it allows to
jump to pertinent positions as in the QuickFix list.

This script replaces these NORMAL MODE commands with more desirable behavior
ones of the QuickFix list.

## `jceb/vim-orgmode`

**This has not been used much but interesting.  (commented out now)**

## `airblade/vim-gitgutter`

**This is not used but interesting. (not used recently under this configuration)**

Checks diff from the repository contents asynchronously without blocking editor
response and mark changed lines.

## `vim-airline/vim-airline` and `vim-airline/vim-airline-themes`

I understand this is only visual sugar candy and not much functionality
improvement as Gurus told me.

But it was irresistible ... sigh ... forgive me for my weakness.  I try to use
this with minimal complications, though.

Other similar packages such as `rbong/vim-crystalline` and
`itchyny/lightline.vim` require you to write custom script from scratch and if
such scripts are added, their claimed advantages may not be true any more.
On the other side, the popular `vim-airline` seems to have addressed all the
interference issues already and works as out-of-box.

If I need really light statusline, I use bare static status line string defined
in `~/.vim/vimrc`).  If vim-airline is active, this setting is overridden.

<!-- vim: set sw=2 sts=2 ai si et tw=79 ft=markdown: -->
