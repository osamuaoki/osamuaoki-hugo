---
title: "Windows from Linux (1)"
date: 2023-02-13T00:00:00+00:01
categories:
  - desktop
  - english
tags:
  - windows
slug: windows-1
---

This can be automated by using [https://github.com/WoeUSB/WoeUSB](https://github.com/WoeUSB/WoeUSB) -- A Microsoft Windows® USB installation media preparer for GNU+Linux

Let's see what is involved.

## Information related to how to install Windows

The official Microsoft documentation gives us good entry points:

- [Install Windows from a USB Flash Drive](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/install-windows-from-a-usb-flash-drive)
- [Windows Setup: Installing using the MBR or GPT partition style](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/windows-setup-installing-using-the-mbr-or-gpt-partition-style?source=recommendations&view=windows-11)
- [Switch from legacy MBR disk to GPT disk with Windows 10](https://learn.microsoft.com/en-us/windows-hardware/drivers/bringup/switch-from-legacy-mbr-disk-to-gpt-disk-with-windows-10)
- [Create a Bootable USB Flash Drive](https://learn.microsoft.com/en-US/windows-server-essentials/install/create-a-bootable-usb-flash-drive)
- [Windows 10 ISO image download page](https://www.microsoft.com/en-US/software-download/windows10ISO)
- [Windows 11 ISO image download page](https://www.microsoft.com/en-US/software-download/windows11)

## Useful tools on Debian to manipulate disk data 

- [gdisk](https://packages.debian.org/sid/gdisk) -- GPT fdisk text-mode partitioning tool (with in place conversion of MBR to GPT)
- [parted](https://packages.debian.org/sid/parted) -- disk partition manipulator (CLI)
- [gparted](https://packages.debian.org/sid/gparted) -- GNOME partition editor (GUI)
- [msb](https://packages.debian.org/sid/msb) -- Master Boot Record for IBM-PC compatible computers
- [wimtools](https://packages.debian.org/unstable/wimtools) -- Tools for manipulating Windows Imaging files

## Key point to use the official ISO image on the USB flash drive

The Windows ISO image contains `sources/install.wim` which is about 5GiB and exceeds 4 GiB filesize limit on FAT32 frequently used for the USB flash disk.

If your image is larger than the filesize limit, use `wimsplit`, or equivalently `wimlib-imagex split`, to split WIMFILE into parts.

## How to create a USB flash drive to install Windows

The following is for Windows USB install via UEFI.

- Download Windows 10 install media
- Format USB flash drive with FAT32 on GPT
- Copy everything in the ISO image to USB flash drive
  - split `sources/install.wim` to avoid filesize limitation

If your UEFI supports NTFS, you can skip splitting `sources/install.wim`.  (I
read this tip somewhere before but I haven't test this.)

## Related articles and resources

- [Linux環境でWindows10のインストールUSBメモリを作成](https://blog.be-dama.com/2021/08/03/linux_winboot_usb/)
- [Create a windows system from scratch using Linux](http://reboot.pro/topic/20468-create-a-windows-system-from-scratch-using-linux/)
- [Rufus -- The Reliable USB Formatting Utility](https://github.com/pbatard/rufus)
- [UEFI:NTFS - Boot NTFS or exFAT partitions from UEFI](https://github.com/pbatard/uefi-ntfs)

<!-- vim: set sw=4 sts=4 ai si et tw=79 ft=markdown: -->
